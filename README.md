# Distributed Storage Systems Course | Lab 2 | Tupichenko Mila | P3309

## Задание

Цель работы - на выделенном узле создать и сконфигурировать новый кластер БД Postgres, саму БД, табличные пространства и
новую роль, а также произвести наполнение базы в соответствии с заданием. Отчёт по работе должен содержать все команды
по настройке, скрипты, а также измененные строки конфигурационных файлов.

Способ подключения к узлу из сети Интернет через helios: ```ssh -J sXXXXXX@helios.cs.ifmo.ru:2222 postgresY@pgZZZ```
Способ подключения к узлу из сети факультета: ```ssh postgresY@pgZZZ```
Номер выделенного узла ```pgZZZ```, а также логин и пароль для подключения Вам выдаст преподаватель.

---

### Этап 1. Инициализация кластера БД

- Директория кластера: ```$HOME/tah70```
- Кодировка: ```ISO_8859_5```
- Локаль: английская
- Параметры инициализации задать через переменные окружения

---

### Этап 2. Конфигурация и запуск сервера БД

- Способы подключения: 1) Unix-domain сокет в режиме peer; 2) сокет TCP/IP, только localhost
- Номер порта: 9136
- Способ аутентификации TCP/IP клиентов: по паролю MD5
- Остальные способы подключений запретить.
- Настроить следующие параметры сервера БД:
    - ```max_connections```
    - ```shared_buffers```
    - ```temp_buffers```
    - ```work_mem```
    - ```checkpoint_timeout```
    - ```effective_cache_size```
    - ```fsync```
    - ```commit_delay```

Параметры должны быть подобраны в соответствии со сценарием OLAP:

- 6 одновременных пользователей, пакетная запись/чтение данных по 256МБ.
- Директория WAL файлов: ```$PGDATA/pg_wal```
- Формат лог-файлов: ```.log```
- Уровень сообщений лога: ```WARNING```
- Дополнительно логировать: контрольные точки и попытки подключения

---

### Этап 3. Дополнительные табличные пространства и наполнение базы

- Создать новое табличное пространство для индексов: ```$HOME/vwp40```
- На основе template1 создать новую базу: ```fargoldcity```
- Создать новую роль, предоставить необходимые права, разрешить подключение к базе.
- От имени новой роли (не администратора) произвести наполнение ВСЕХ созданных баз тестовыми наборами данных. ВСЕ
  табличные пространства должны использоваться по назначению.
- Вывести список всех табличных пространств кластера и содержащиеся в них объекты.